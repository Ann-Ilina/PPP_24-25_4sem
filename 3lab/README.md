# Нечёткий поиск (Вариант 3, Этап 2)
## Выполнила: Ильина Анна ПМ23-2
### Описание проекта
Этот проект представляет собой систему нечёткого поиска (Вариант 3, Этап 2) в рамках лабораторной работы по курсу "Практикум по программированию". Проект расширяет функционал предыдущего этапа, добавляя асинхронную обработку запросов через Celery, отправку уведомлений в реальном времени с использованием WebSocket и интеграцию с Redis. Используются алгоритмы Левенштейна для поиска похожих слов в текстовых корпусах.
### Цели проекта

- Реализовать асинхронный нечёткий поиск слов с использованием алгоритма Левенштейна.
- Обеспечить отправку уведомлений о статусе поиска через WebSocket.
- Использовать Celery для фоновой обработки задач.
- Интегрировать Redis для передачи уведомлений между компонентами.
- Предоставить клиент для интерактивного и скриптового взаимодействия с системой.

### Технологии

FastAPI: Веб-фреймворк для создания API.
SQLite: Легковесная база данных для хранения корпусов.
SQLAlchemy: ORM для работы с базой данных.
Celery: Система распределённых задач для асинхронной обработки.
Redis: Брокер сообщений и хранилище для Celery и WebSocket.
aiohttp: Асинхронная библиотека для WebSocket-клиента.
Python 3.9+: Язык программирования.


### Структура проекта
3lab/
├── app/
│   ├── __init__.py
│   ├── api/
│   │   └── __pycache__
│   │   └── endpoints.py      # Эндпоинты API
│   ├── auth/
│   │   └── __pycache__
│   │   ├── __init__.py
│   │   └── auth.py           # Аутентификация пользователей
│   ├── celery/
│   │   └── __pycache__
│   │   ├── __init__.py
│   │   └── tasks.py          # Логика обработки задач (поиск)
│   ├── core/
│   │   └── __pycache__
│   ├── cruds/
│   │   └── __pycache__
│   │   ├── __init__.py
│   │   └── cruds.py          # CRUD-операции для работы с базой данных
│   ├── db/
│   │   └── db.py             # Настройка базы данных (SQLite)
│   ├── models/
│   │   └── __pycache__
│   │   └── models.py         # Модели данных (User, Corpus)
│   ├── schemas/
│   │   └── __pycache__
│   │   └── schemas.py        # Схемы Pydantic для валидации данных
│   └── websocket/
│       └── __pycache__
│       ├── __init__.py
│       └── websocket.py      # WebSocket-эндпоинт для уведомлений
├── main.py                   # Точка входа приложения
├── client.py                 # Консольный клиент для взаимодействия с API
├── requirements.txt          # Зависимости проекта
├── venv/                     # Виртуальное окружение
└── README.md                 # Документация


### Теория: Нечёткий поиск
Нечёткий поиск позволяет находить слова, похожие на заданное, даже при наличии опечаток. В этом проекте используется алгоритм Левенштейна для вычисления расстояния между словами. Расстояние Левенштейна определяется как минимальное количество операций (вставка, удаление, замена символа), необходимых для преобразования одного слова в другое.
Пример

Слово 1: "srting".
Слово 2: "stringstring".
Операции: Вставка "s" в начало, замена "t" на "g" → расстояние = 2 (но в данном случае результат показывает 6, что может быть связано с особенностями корпуса).


### Установка и запуск
#### Требования

- Python 3.9 или выше.
- Установленный pip для управления зависимостями.
- Redis (для работы Celery и WebSocket).

#### Установка

Склонируйте репозиторий или скопируйте проект в локальную директорию.
Перейдите в папку проекта:cd 3lab


Установите зависимости из файла requirements.txt:python -m venv venv
source venv/bin/activate  # Для Windows: venv\Scripts\activate
pip install -r requirements.txt

Содержимое requirements.txt:fastapi
uvicorn
sqlalchemy
passlib[bcrypt]
python-jose[cryptography]
pydantic
websockets
celery==5.3.6  
billiard==4.2.0
aiohttp
pydantic-settings



### Установка Redis

Скачайте Redis с официального сайта или используйте бинарные файлы для Windows.
Запустите Redis:cd /c/Redis
./redis-server.exe

Убедитесь, что Redis работает на localhost:6379.

### Запуск проекта
1. Запустите Redis
cd /c/Redis
./redis-server.exe

2. Запустите сервер
Запустите FastAPI-сервер с помощью Uvicorn:
uvicorn main:app --reload

Сервер будет доступен по адресу http://127.0.0.1:8000.
3. Запустите Celery
Запустите воркер Celery для обработки задач:
celery -A app.celery.tasks.celery_app worker --pool=solo --loglevel=info

Убедитесь, что Celery подключился к Redis (Connected to redis://localhost:6379/0).
4. Запустите клиент
Клиент поддерживает два режима: интерактивный и скриптовый.
Интерактивный режим
Запустите клиент:
python client.py


Введите имя пользователя: string1
Введите пароль: string1
Доступные команды:
search: Выполнить поиск слова (например, srting, корпус 4, алгоритм levenshtein).
exit: Завершить работу клиента.



Пример вывода:
Уведомление: {
  "status": "STARTED",
  "task_id": "8b7b9bbc-b3ed-4685-aa2b-33cd13f3b027",
  "word": "srting",
  "algorithm": "levenshtein"
}
Уведомление: {
  "status": "PROGRESS",
  "task_id": "8b7b9bbc-b3ed-4685-aa2b-33cd13f3b027",
  "progress": 100,
  "current_word": "processing word 1/1"
}
Уведомление: {
  "status": "COMPLETED",
  "task_id": "8b7b9bbc-b3ed-4685-aa2b-33cd13f3b027",
  "execution_time": 0.0,
  "results": [
    {
      "word": "stringstring",
      "distance": 6
    }
  ]
}

### Устранение неполадок

- Redis не запускается: Убедитесь, что порт 6379 свободен, и путь к redis-server.exe указан верно.
- Celery не подключается к Redis: Проверьте, что Redis запущен и доступен на localhost:6379.
- Клиент не получает уведомления: Убедитесь, что сервер и Celery запущены, и проверьте логи для ошибок.

### Вывод
Проект успешно реализует требования Этапа 2 для Варианта 3:

- Реализована асинхронная обработка поиска через Celery.
- Уведомления отправляются в реальном времени через WebSocket.
- Использованы FastAPI, SQLite, SQLAlchemy, Celery и Redis.
- Клиент поддерживает интерактивный и скриптовый режимы.
- Данные корректно обрабатываются и возвращаются с вычисленным расстоянием Левенштейна.
